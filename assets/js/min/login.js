var loginForm=document.getElementById("loginForm");document.addEventListener("DOMContentLoaded",(function(){fetch("/api/checkSession").then((function(e){return e.json()})).then((function(e){e.loggedIn&&(window.location.href="/home")})).catch((function(e){}))})),loginForm.addEventListener("submit",(function(e){e.preventDefault();var n=document.getElementById("username").value,t=document.getElementById("password").value;if(n&&t){var o=loginForm.querySelector('button[type="submit"]'),i=o.textContent;o.disabled=!0,o.textContent="Logging in...",fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:t})}).then((function(e){return e.json()})).then((function(e){"success"===e.status?(notify(e.message,"success"),setTimeout((function(){window.location.href="/home"}),1e3)):(notify("Login failed: "+e.message,"error"),o.disabled=!1,o.textContent=i)})).catch((function(e){console.error("Error:",e),notify("An error occurred, please try again.","error"),o.disabled=!1,o.textContent=i}))}else notify("Please fill in all fields","error")}));